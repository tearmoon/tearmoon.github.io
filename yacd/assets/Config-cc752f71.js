import{r as z,R as p,P as m,j as t,s as M,h as P,c as K,i as Q,k as $,l as T,n as X,d as A,o as Y,g as B,q as Z,t as ee,v as b,w as te,x as ne,y as se,u as re,z as ae,C as oe,A as le,B as w,D as ie,E as ce,F as de}from"./index-8c88a27d.js";import{r as ue}from"./logs-3963ded4.js";import{S as C}from"./Select-ce3535fd.js";import{R as pe}from"./rotate-cw-dcc53202.js";function _(){return _=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},_.apply(this,arguments)}function he(e,r){if(e==null)return{};var a=fe(e,r),s,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)s=o[n],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function fe(e,r){if(e==null)return{};var a={},s=Object.keys(e),n,o;for(o=0;o<s.length;o++)n=s[o],!(r.indexOf(n)>=0)&&(a[n]=e[n]);return a}var S=z.forwardRef(function(e,r){var a=e.color,s=a===void 0?"currentColor":a,n=e.size,o=n===void 0?24:n,c=he(e,["color","size"]);return p.createElement("svg",_({ref:r,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),p.createElement("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),p.createElement("polyline",{points:"16 17 21 12 16 7"}),p.createElement("line",{x1:"21",y1:"12",x2:"9",y2:"12"}))});S.propTypes={color:m.string,size:m.oneOfType([m.string,m.number])};S.displayName="LogOut";const me=S;function O(){return O=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},O.apply(this,arguments)}function ge(e,r){if(e==null)return{};var a=xe(e,r),s,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)s=o[n],!(r.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function xe(e,r){if(e==null)return{};var a={},s=Object.keys(e),n,o;for(o=0;o<s.length;o++)n=s[o],!(r.indexOf(n)>=0)&&(a[n]=e[n]);return a}var N=z.forwardRef(function(e,r){var a=e.color,s=a===void 0?"currentColor":a,n=e.size,o=n===void 0?24:n,c=ge(e,["color","size"]);return p.createElement("svg",O({ref:r,xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:s,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),p.createElement("polyline",{points:"3 6 5 6 21 6"}),p.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),p.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),p.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))});N.propTypes={color:m.string,size:m.oneOfType([m.string,m.number])};N.displayName="Trash2";const ve=N,{useState:ye,useRef:je,useEffect:be,useCallback:we}=P;function Ce(e){return t.jsx("input",{className:M.input,...e})}function ke({value:e,...r}){const[a,s]=ye(e),n=je(e);be(()=>{n.current!==e&&s(e),n.current=e},[e]);const o=we(c=>s(c.target.value),[s]);return t.jsx("input",{className:M.input,value:a,onChange:o,...r})}const _e="_root_vyhny_1",Oe="_section_vyhny_2",Pe="_wrapSwitch_vyhny_27",Se="_sep_vyhny_33",Ne="_label_vyhny_46",i={root:_e,section:Oe,wrapSwitch:Pe,sep:Se,label:Ne},Ie="_fieldset_1ghjp_1",Ee="_input_1ghjp_9",Le="_cnt_1ghjp_9",k={fieldset:Ie,input:Ee,cnt:Le};function Re({OptionComponent:e,optionPropsList:r,selectedIndex:a,onChange:s}){const n=K("visually-hidden",k.input),o=c=>{s(c.target.value)};return t.jsx("fieldset",{className:k.fieldset,children:r.map((c,g)=>t.jsxs("label",{children:[t.jsx("input",{type:"radio",checked:a===g,name:"selection",value:g,"aria-labelledby":"traffic chart type "+g,onChange:o,className:n}),t.jsx("div",{className:k.cnt,children:t.jsx(e,{...c})})]},g))})}const{useMemo:$e}=P,Te={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},V=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],ze=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Me=V;function Ae({id:e}){const r=Q.read(),a=$e(()=>({labels:Me,datasets:[{...$,...T[e].up,data:V},{...$,...T[e].down,data:ze}]}),[e]),s="chart-"+e;return X(r.Chart,s,a,null,Te),t.jsx("div",{style:{width:100,padding:5},children:t.jsx("canvas",{id:s})})}const{useEffect:W,useState:Be,useCallback:f,useRef:Ve,useMemo:We}=P,Fe=[{id:0},{id:1},{id:2},{id:3}],Ue=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],De=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"tproxy-port",label:"tProxy Port"}],He=[["zh","中文"],["en","English"]],Ge=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],qe=e=>({configs:Y(e),apiConfig:B(e)}),Je=e=>({selectedChartStyleIndex:ce(e),latencyTestUrl:de(e),apiConfig:B(e)}),Ke=A(Je)(Ye),st=A(qe)(Qe);function Qe({dispatch:e,configs:r,apiConfig:a}){return W(()=>{e(Z(a))},[e,a]),t.jsx(Ke,{configs:r})}function Xe(e){return e&&e.meta&&!e.premium?"Clash.Meta ":e&&e.meta&&e.premium?"sing-box ":"Clash Premium"}function Ye({dispatch:e,configs:r,selectedChartStyleIndex:a,latencyTestUrl:s,apiConfig:n}){const[o,c]=Be(r),g=Ve(r);W(()=>{g.current!==r&&c(r),g.current=r},[r]);const F=f(()=>{e(ee("apiConfig"))},[e]),x=f((l,d)=>{c({...o,[l]:d})},[o]),U=f(l=>{const d="allow-lan",u=l;x(d,u),e(b(n,{"allow-lan":u}))},[n,e,x]),y=f(({name:l,value:d})=>{switch(l){case"mode":case"log-level":x(l,d),e(b(n,{[l]:d})),l==="log-level"&&ue({...n,logLevel:d});break;case"tproxy-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(d!==""){const u=parseInt(d,10);if(u<0||u>65535)return}x(l,d);break;default:return}},[n,e,x]),D=f(l=>y(l.target),[y]),{selectChartStyleIndex:H,updateAppConfig:I}=te(),E=f(l=>{const d=l.target,{name:u,value:R}=d;switch(u){case"port":case"socks-port":case"mixed-port":case"redir-port":case"tproxy-port":{const j=parseInt(R,10);if(j<0||j>65535)return;e(b(n,{[u]:j}));break}case"latencyTestUrl":{I(u,R);break}default:throw new Error(`unknown input name ${u}`)}},[n,e,I]),G=f(()=>{e(ne(n))},[n,e]),q=f(()=>{e(se(n))},[n,e]),J=We(()=>{const l=o.mode;return typeof l=="string"&&l[0].toUpperCase()+l.slice(1)},[o.mode]),{t:h,i18n:L}=re(),{data:v}=ae(["/version",n],()=>ie("/version",n));return t.jsxs("div",{children:[t.jsx(oe,{title:h("Config")}),t.jsxs("div",{className:i.root,children:[v.meta&&v.premium||De.map(l=>o[l.key]!==void 0?t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:l.label}),t.jsx(Ce,{name:l.key,value:o[l.key],onChange:D,onBlur:E})]},l.key):null),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Mode"}),t.jsx(C,{options:Ge,selected:J,onChange:l=>y({name:"mode",value:l.target.value})})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Log Level"}),t.jsx(C,{options:Ue,selected:o["log-level"],onChange:l=>y({name:"log-level",value:l.target.value})})]}),v.meta&&v.premium||t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Allow LAN"}),t.jsx("div",{className:i.wrapSwitch,children:t.jsx(le,{name:"allow-lan",checked:o["allow-lan"],onChange:U})})]})]}),t.jsx("div",{className:i.sep,children:t.jsx("div",{})}),t.jsxs("div",{className:i.section,children:[t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"Reload"}),t.jsx(w,{start:t.jsx(pe,{size:16}),label:h("reload_config_file"),onClick:G})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:"FakeIP"}),t.jsx(w,{start:t.jsx(ve,{size:16}),label:h("flush_fake_ip_pool"),onClick:q})]})]}),t.jsx("div",{className:i.sep,children:t.jsx("div",{})}),t.jsxs("div",{className:i.section,children:[t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:h("latency_test_url")}),t.jsx(ke,{name:"latencyTestUrl",type:"text",value:s,onBlur:E})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:h("lang")}),t.jsx("div",{children:t.jsx(C,{options:He,selected:L.language,onChange:l=>L.changeLanguage(l.target.value)})})]}),t.jsxs("div",{children:[t.jsx("div",{className:i.label,children:h("chart_style")}),t.jsx(Re,{OptionComponent:Ae,optionPropsList:Fe,selectedIndex:a,onChange:H})]}),t.jsxs("div",{children:[t.jsxs("div",{className:i.label,children:[h("current_backend"),t.jsx("p",{children:Xe(v)+n.baseURL})]}),t.jsx("div",{className:i.label,children:"Action"}),t.jsx(w,{start:t.jsx(me,{size:16}),label:h("switch_backend"),onClick:F})]})]})]})}export{st as default};
